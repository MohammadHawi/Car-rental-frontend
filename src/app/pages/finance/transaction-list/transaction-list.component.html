<div class="page-container">
    <div class="page-header">
      <h1 class="page-title">Transactions</h1>
      <div class="header-actions">
        <button mat-raised-button color="primary" (click)="openTransactionForm()">
          <mat-icon>add</mat-icon>
          New Transaction
        </button>
      </div>
    </div>
    
    <div class="filters-container">
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>Search</mat-label>
        <input matInput [(ngModel)]="searchTerm" (keyup.enter)="onSearch()">
        <button mat-icon-button matSuffix (click)="onSearch()">
          <mat-icon>search</mat-icon>
        </button>
      </mat-form-field>
      
      <mat-form-field appearance="outline">
        <mat-label>Type</mat-label>
        <mat-select [(ngModel)]="selectedType" (selectionChange)="onTypeFilterChange()">
          <mat-option value="all">All</mat-option>
          <mat-option value="income">Income</mat-option>
          <mat-option value="expense">Expense</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    
    <div *ngIf="loading" class="loading-container">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Loading transactions...</p>
    </div>
    
    <div *ngIf="!loading" class="transactions-table-container">
      <table mat-table [dataSource]="filteredTransactions" class="transactions-table">
        <!-- Date Column -->
        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef>Date</th>
          <td mat-cell *matCellDef="let transaction">{{ transaction.date | date:'mediumDate' }}</td>
        </ng-container>
        
        <!-- Type Column -->
        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef>Type</th>
          <td mat-cell *matCellDef="let transaction">
            <span class="transaction-type" [ngClass]="{'income': transaction.type === 0, 'expense': transaction.type === 1}">
              {{ getTypeName(transaction.type) }}
            </span>
          </td>
        </ng-container>
        
        <!-- Category Column -->
        <ng-container matColumnDef="category">
          <th mat-header-cell *matHeaderCellDef>Category</th>
          <td mat-cell *matCellDef="let transaction">{{ getCategoryName(transaction.category) }}</td>
        </ng-container>
        
        <!-- Description Column -->
        <ng-container matColumnDef="description">
          <th mat-header-cell *matHeaderCellDef>Description</th>
          <td mat-cell *matCellDef="let transaction">{{ transaction.description }}</td>
        </ng-container>
        
        <!-- Amount Column -->
        <ng-container matColumnDef="amount">
          <th mat-header-cell *matHeaderCellDef>Amount</th>
          <td mat-cell *matCellDef="let transaction" [ngClass]="{'income-amount': transaction.type === 0, 'expense-amount': transaction.type === 1}">
            ${{ transaction.amount | number:'1.2-2' }}
          </td>
        </ng-container>
        
        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef>Actions</th>
          <td mat-cell *matCellDef="let transaction">
            <button mat-icon-button color="primary" (click)="openTransactionForm(transaction)" title="Edit">
              <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="deleteTransaction(transaction.id)" title="Delete">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </ng-container>
        
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
      
      <div *ngIf="filteredTransactions.length === 0" class="no-data">
        <p>No transactions found.</p>
      </div>
    </div>
  </div>